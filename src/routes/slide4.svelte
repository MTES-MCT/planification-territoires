<script lang="ts">
  import * as d3 from "d3";
  import Treemap from "$lib/treemap.svelte";

  // const dataSrc = `[{"name":"flare","size":null},{"name":"flare.analytics","size":null},{"name":"flare.analytics.cluster","size":null},{"name":"flare.analytics.cluster.AgglomerativeCluster","size":3938},{"name":"flare.analytics.cluster.CommunityStructure","size":3812},{"name":"flare.analytics.cluster.HierarchicalCluster","size":6714},{"name":"flare.analytics.cluster.MergeEdge","size":743},{"name":"flare.analytics.graph","size":null},{"name":"flare.analytics.graph.BetweennessCentrality","size":3534},{"name":"flare.analytics.graph.LinkDistance","size":5731},{"name":"flare.analytics.graph.MaxFlowMinCut","size":7840},{"name":"flare.analytics.graph.ShortestPaths","size":5914},{"name":"flare.analytics.graph.SpanningTree","size":3416},{"name":"flare.analytics.optimization","size":null},{"name":"flare.analytics.optimization.AspectRatioBanker","size":7074},{"name":"flare.animate","size":null},{"name":"flare.animate.Easing","size":17010},{"name":"flare.animate.FunctionSequence","size":5842},{"name":"flare.animate.interpolate","size":null},{"name":"flare.animate.interpolate.ArrayInterpolator","size":1983},{"name":"flare.animate.interpolate.ColorInterpolator","size":2047},{"name":"flare.animate.interpolate.DateInterpolator","size":1375},{"name":"flare.animate.interpolate.Interpolator","size":8746},{"name":"flare.animate.interpolate.MatrixInterpolator","size":2202},{"name":"flare.animate.interpolate.NumberInterpolator","size":1382},{"name":"flare.animate.interpolate.ObjectInterpolator","size":1629},{"name":"flare.animate.interpolate.PointInterpolator","size":1675},{"name":"flare.animate.interpolate.RectangleInterpolator","size":2042},{"name":"flare.animate.ISchedulable","size":1041},{"name":"flare.animate.Parallel","size":5176},{"name":"flare.animate.Pause","size":449},{"name":"flare.animate.Scheduler","size":5593},{"name":"flare.animate.Sequence","size":5534},{"name":"flare.animate.Transition","size":9201},{"name":"flare.animate.Transitioner","size":19975},{"name":"flare.animate.TransitionEvent","size":1116},{"name":"flare.animate.Tween","size":6006},{"name":"flare.data","size":null},{"name":"flare.data.converters","size":null},{"name":"flare.data.converters.Converters","size":721},{"name":"flare.data.converters.DelimitedTextConverter","size":4294},{"name":"flare.data.converters.GraphMLConverter","size":9800},{"name":"flare.data.converters.IDataConverter","size":1314},{"name":"flare.data.converters.JSONConverter","size":2220},{"name":"flare.data.DataField","size":1759},{"name":"flare.data.DataSchema","size":2165},{"name":"flare.data.DataSet","size":586},{"name":"flare.data.DataSource","size":3331},{"name":"flare.data.DataTable","size":772},{"name":"flare.data.DataUtil","size":3322},{"name":"flare.display","size":null},{"name":"flare.display.DirtySprite","size":8833},{"name":"flare.display.LineSprite","size":1732},{"name":"flare.display.RectSprite","size":3623},{"name":"flare.display.TextSprite","size":10066},{"name":"flare.flex","size":null},{"name":"flare.flex.FlareVis","size":4116},{"name":"flare.physics","size":null},{"name":"flare.physics.DragForce","size":1082},{"name":"flare.physics.GravityForce","size":1336},{"name":"flare.physics.IForce","size":319},{"name":"flare.physics.NBodyForce","size":10498},{"name":"flare.physics.Particle","size":2822},{"name":"flare.physics.Simulation","size":9983},{"name":"flare.physics.Spring","size":2213},{"name":"flare.physics.SpringForce","size":1681},{"name":"flare.query","size":null},{"name":"flare.query.AggregateExpression","size":1616},{"name":"flare.query.And","size":1027},{"name":"flare.query.Arithmetic","size":3891},{"name":"flare.query.Average","size":891},{"name":"flare.query.BinaryExpression","size":2893},{"name":"flare.query.Comparison","size":5103},{"name":"flare.query.CompositeExpression","size":3677},{"name":"flare.query.Count","size":781},{"name":"flare.query.DateUtil","size":4141},{"name":"flare.query.Distinct","size":933},{"name":"flare.query.Expression","size":5130},{"name":"flare.query.ExpressionIterator","size":3617},{"name":"flare.query.Fn","size":3240},{"name":"flare.query.If","size":2732},{"name":"flare.query.IsA","size":2039},{"name":"flare.query.Literal","size":1214},{"name":"flare.query.Match","size":3748},{"name":"flare.query.Maximum","size":843},{"name":"flare.query.methods","size":null},{"name":"flare.query.methods.add","size":593},{"name":"flare.query.methods.and","size":330},{"name":"flare.query.methods.average","size":287},{"name":"flare.query.methods.count","size":277},{"name":"flare.query.methods.distinct","size":292},{"name":"flare.query.methods.div","size":595},{"name":"flare.query.methods.eq","size":594},{"name":"flare.query.methods.fn","size":460},{"name":"flare.query.methods.gt","size":603},{"name":"flare.query.methods.gte","size":625},{"name":"flare.query.methods.iff","size":748},{"name":"flare.query.methods.isa","size":461},{"name":"flare.query.methods.lt","size":597},{"name":"flare.query.methods.lte","size":619},{"name":"flare.query.methods.max","size":283},{"name":"flare.query.methods.min","size":283},{"name":"flare.query.methods.mod","size":591},{"name":"flare.query.methods.mul","size":603},{"name":"flare.query.methods.neq","size":599},{"name":"flare.query.methods.not","size":386},{"name":"flare.query.methods.or","size":323},{"name":"flare.query.methods.orderby","size":307},{"name":"flare.query.methods.range","size":772},{"name":"flare.query.methods.select","size":296},{"name":"flare.query.methods.stddev","size":363},{"name":"flare.query.methods.sub","size":600},{"name":"flare.query.methods.sum","size":280},{"name":"flare.query.methods.update","size":307},{"name":"flare.query.methods.variance","size":335},{"name":"flare.query.methods.where","size":299},{"name":"flare.query.methods.xor","size":354},{"name":"flare.query.methods._","size":264},{"name":"flare.query.Minimum","size":843},{"name":"flare.query.Not","size":1554},{"name":"flare.query.Or","size":970},{"name":"flare.query.Query","size":13896},{"name":"flare.query.Range","size":1594},{"name":"flare.query.StringUtil","size":4130},{"name":"flare.query.Sum","size":791},{"name":"flare.query.Variable","size":1124},{"name":"flare.query.Variance","size":1876},{"name":"flare.query.Xor","size":1101},{"name":"flare.scale","size":null},{"name":"flare.scale.IScaleMap","size":2105},{"name":"flare.scale.LinearScale","size":1316},{"name":"flare.scale.LogScale","size":3151},{"name":"flare.scale.OrdinalScale","size":3770},{"name":"flare.scale.QuantileScale","size":2435},{"name":"flare.scale.QuantitativeScale","size":4839},{"name":"flare.scale.RootScale","size":1756},{"name":"flare.scale.Scale","size":4268},{"name":"flare.scale.ScaleType","size":1821},{"name":"flare.scale.TimeScale","size":5833},{"name":"flare.util","size":null},{"name":"flare.util.Arrays","size":8258},{"name":"flare.util.Colors","size":10001},{"name":"flare.util.Dates","size":8217},{"name":"flare.util.Displays","size":12555},{"name":"flare.util.Filter","size":2324},{"name":"flare.util.Geometry","size":10993},{"name":"flare.util.heap","size":null},{"name":"flare.util.heap.FibonacciHeap","size":9354},{"name":"flare.util.heap.HeapNode","size":1233},{"name":"flare.util.IEvaluable","size":335},{"name":"flare.util.IPredicate","size":383},{"name":"flare.util.IValueProxy","size":874},{"name":"flare.util.math","size":null},{"name":"flare.util.math.DenseMatrix","size":3165},{"name":"flare.util.math.IMatrix","size":2815},{"name":"flare.util.math.SparseMatrix","size":3366},{"name":"flare.util.Maths","size":17705},{"name":"flare.util.Orientation","size":1486},{"name":"flare.util.palette","size":null},{"name":"flare.util.palette.ColorPalette","size":6367},{"name":"flare.util.palette.Palette","size":1229},{"name":"flare.util.palette.ShapePalette","size":2059},{"name":"flare.util.palette.SizePalette","size":2291},{"name":"flare.util.Property","size":5559},{"name":"flare.util.Shapes","size":19118},{"name":"flare.util.Sort","size":6887},{"name":"flare.util.Stats","size":6557},{"name":"flare.util.Strings","size":22026},{"name":"flare.vis","size":null},{"name":"flare.vis.axis","size":null},{"name":"flare.vis.axis.Axes","size":1302},{"name":"flare.vis.axis.Axis","size":24593},{"name":"flare.vis.axis.AxisGridLine","size":652},{"name":"flare.vis.axis.AxisLabel","size":636},{"name":"flare.vis.axis.CartesianAxes","size":6703},{"name":"flare.vis.controls","size":null},{"name":"flare.vis.controls.AnchorControl","size":2138},{"name":"flare.vis.controls.ClickControl","size":3824},{"name":"flare.vis.controls.Control","size":1353},{"name":"flare.vis.controls.ControlList","size":4665},{"name":"flare.vis.controls.DragControl","size":2649},{"name":"flare.vis.controls.ExpandControl","size":2832},{"name":"flare.vis.controls.HoverControl","size":4896},{"name":"flare.vis.controls.IControl","size":763},{"name":"flare.vis.controls.PanZoomControl","size":5222},{"name":"flare.vis.controls.SelectionControl","size":7862},{"name":"flare.vis.controls.TooltipControl","size":8435},{"name":"flare.vis.data","size":null},{"name":"flare.vis.data.Data","size":20544},{"name":"flare.vis.data.DataList","size":19788},{"name":"flare.vis.data.DataSprite","size":10349},{"name":"flare.vis.data.EdgeSprite","size":3301},{"name":"flare.vis.data.NodeSprite","size":19382},{"name":"flare.vis.data.render","size":null},{"name":"flare.vis.data.render.ArrowType","size":698},{"name":"flare.vis.data.render.EdgeRenderer","size":5569},{"name":"flare.vis.data.render.IRenderer","size":353},{"name":"flare.vis.data.render.ShapeRenderer","size":2247},{"name":"flare.vis.data.ScaleBinding","size":11275},{"name":"flare.vis.data.Tree","size":7147},{"name":"flare.vis.data.TreeBuilder","size":9930},{"name":"flare.vis.events","size":null},{"name":"flare.vis.events.DataEvent","size":2313},{"name":"flare.vis.events.SelectionEvent","size":1880},{"name":"flare.vis.events.TooltipEvent","size":1701},{"name":"flare.vis.events.VisualizationEvent","size":1117},{"name":"flare.vis.legend","size":null},{"name":"flare.vis.legend.Legend","size":20859},{"name":"flare.vis.legend.LegendItem","size":4614},{"name":"flare.vis.legend.LegendRange","size":10530},{"name":"flare.vis.operator","size":null},{"name":"flare.vis.operator.distortion","size":null},{"name":"flare.vis.operator.distortion.BifocalDistortion","size":4461},{"name":"flare.vis.operator.distortion.Distortion","size":6314},{"name":"flare.vis.operator.distortion.FisheyeDistortion","size":3444},{"name":"flare.vis.operator.encoder","size":null},{"name":"flare.vis.operator.encoder.ColorEncoder","size":3179},{"name":"flare.vis.operator.encoder.Encoder","size":4060},{"name":"flare.vis.operator.encoder.PropertyEncoder","size":4138},{"name":"flare.vis.operator.encoder.ShapeEncoder","size":1690},{"name":"flare.vis.operator.encoder.SizeEncoder","size":1830},{"name":"flare.vis.operator.filter","size":null},{"name":"flare.vis.operator.filter.FisheyeTreeFilter","size":5219},{"name":"flare.vis.operator.filter.GraphDistanceFilter","size":3165},{"name":"flare.vis.operator.filter.VisibilityFilter","size":3509},{"name":"flare.vis.operator.IOperator","size":1286},{"name":"flare.vis.operator.label","size":null},{"name":"flare.vis.operator.label.Labeler","size":9956},{"name":"flare.vis.operator.label.RadialLabeler","size":3899},{"name":"flare.vis.operator.label.StackedAreaLabeler","size":3202},{"name":"flare.vis.operator.layout","size":null},{"name":"flare.vis.operator.layout.AxisLayout","size":6725},{"name":"flare.vis.operator.layout.BundledEdgeRouter","size":3727},{"name":"flare.vis.operator.layout.CircleLayout","size":9317},{"name":"flare.vis.operator.layout.CirclePackingLayout","size":12003},{"name":"flare.vis.operator.layout.DendrogramLayout","size":4853},{"name":"flare.vis.operator.layout.ForceDirectedLayout","size":8411},{"name":"flare.vis.operator.layout.IcicleTreeLayout","size":4864},{"name":"flare.vis.operator.layout.IndentedTreeLayout","size":3174},{"name":"flare.vis.operator.layout.Layout","size":7881},{"name":"flare.vis.operator.layout.NodeLinkTreeLayout","size":12870},{"name":"flare.vis.operator.layout.PieLayout","size":2728},{"name":"flare.vis.operator.layout.RadialTreeLayout","size":12348},{"name":"flare.vis.operator.layout.RandomLayout","size":870},{"name":"flare.vis.operator.layout.StackedAreaLayout","size":9121},{"name":"flare.vis.operator.layout.TreeMapLayout","size":9191},{"name":"flare.vis.operator.Operator","size":2490},{"name":"flare.vis.operator.OperatorList","size":5248},{"name":"flare.vis.operator.OperatorSequence","size":4190},{"name":"flare.vis.operator.OperatorSwitch","size":2581},{"name":"flare.vis.operator.SortOperator","size":2023},{"name":"flare.vis.Visualization","size":16540}]`;
  const dataSrc = `[{"Leviers":"Electrification VP","Traduction physique":"# voitures thermiques remplacées d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1408.8500890114378,"Objectifs SGPE en unité physique":673020.4952488458,"secteur":"Transport","path":"Transport/Electrification VP","label":"Electrification VP\\n\\n# voitures thermiques remplacées d'ici 2030\\n\\n673,02 K\\n\\n1 409 kt CO₂","value":1408.8500890114378,"title":"Transport\\n\\nElectrification VP\\n\\n# voitures thermiques remplacées d'ici 2030\\n\\n673,02 K\\n\\n1 409 kt CO₂"},{"Leviers":"Sobriété transport","Traduction physique":"km voiture évités (annuel) (Sobriété transport)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":366.1930740729935,"Objectifs SGPE en unité physique":2441287160.4866233,"secteur":"Transport","path":"Transport/Sobriété transport","label":"Sobriété transport\\n\\nkm voiture évités (annuel) (Sobriété transport)\\n\\n2 441,29 M\\n\\n366 kt CO₂","value":366.1930740729935,"title":"Transport\\n\\nSobriété transport\\n\\nkm voiture évités (annuel) (Sobriété transport)\\n\\n2 441,29 M\\n\\n366 kt CO₂"},{"Leviers":"Report modal vélo/bus/train","Traduction physique":"km voiture évités (annuel) (Report modal vélo/bus/train)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":604.2246017589598,"Objectifs SGPE en unité physique":4028164011.726399,"secteur":"Transport","path":"Transport/Report modal vélo-bus-train","label":"Report modal vélo/bus/train\\n\\nkm voiture évités (annuel) (Report modal vélo/bus/train)\\n\\n4 028,16 M\\n\\n604 kt CO₂","value":604.2246017589598,"title":"Transport\\n\\nReport modal vélo/bus/train\\n\\nkm voiture évités (annuel) (Report modal vélo/bus/train)\\n\\n4 028,16 M\\n\\n604 kt CO₂"},{"Leviers":"Covoiturage","Traduction physique":"km covoiturage additionnels (annuel)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":362.53476105537584,"Objectifs SGPE en unité physique":2416898407.035839,"secteur":"Transport","path":"Transport/Covoiturage","label":"Covoiturage\\n\\nkm covoiturage additionnels (annuel)\\n\\n2 416,9 M\\n\\n363 kt CO₂","value":362.53476105537584,"title":"Transport\\n\\nCovoiturage\\n\\nkm covoiturage additionnels (annuel)\\n\\n2 416,9 M\\n\\n363 kt CO₂"},{"Leviers":"Bus et cars (élec&efficacité)","Traduction physique":"# bus thermiques remplacés d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":92.87147282450752,"Objectifs SGPE en unité physique":1263.5163877774248,"secteur":"Transport","path":"Transport/Bus et cars (élec&efficacité)","label":"Bus et cars (élec&efficacité)\\n\\n# bus thermiques remplacés d'ici 2030\\n\\n1 263,52\\n\\n93 kt CO₂","value":92.87147282450752,"title":"Transport\\n\\nBus et cars (élec&efficacité)\\n\\n# bus thermiques remplacés d'ici 2030\\n\\n1 263,52\\n\\n93 kt CO₂"},{"Leviers":"Azote","Traduction physique":"T engrais azotés évités (annuel)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":297.2184996148153,"Objectifs SGPE en unité physique":69606.2059987858,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Azote","label":"Azote\\n\\nT engrais azotés évités (annuel)\\n\\n69,61 K\\n\\n297 kt CO₂","value":297.2184996148153,"title":"Agriculture/Forêts/Sols\\n\\nAzote\\n\\nT engrais azotés évités (annuel)\\n\\n69,61 K\\n\\n297 kt CO₂"},{"Leviers":"Elevage","Traduction physique":"réduction têtes bovins","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":689.75003713954,"Objectifs SGPE en unité physique":314808.99130984134,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Elevage","label":"Elevage\\n\\nréduction têtes bovins\\n\\n314,81 K\\n\\n690 kt CO₂","value":689.75003713954,"title":"Agriculture/Forêts/Sols\\n\\nElevage\\n\\nréduction têtes bovins\\n\\n314,81 K\\n\\n690 kt CO₂"},{"Leviers":"Industrie","Traduction physique":"réduction d'emissions du secteur (annuel) (Industrie)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":3772.9793345623943,"Objectifs SGPE en unité physique":0.3313416621401412,"secteur":"Industrie","path":"Industrie/Industrie","label":"Industrie\\n\\nréduction d'emissions du secteur (annuel) (Industrie)\\n\\n0,33\\n\\n3 773 kt CO₂","value":3772.9793345623943,"title":"Industrie\\n\\nIndustrie\\n\\nréduction d'emissions du secteur (annuel) (Industrie)\\n\\n0,33\\n\\n3 773 kt CO₂"},{"Leviers":"Réseaux de chaleur","Traduction physique":"Gwh de production de chaleur passé en ENR (annuel)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":439.7862476145672,"Objectifs SGPE en unité physique":3628.2365428201792,"secteur":"Energie","path":"Energie/Réseaux de chaleur","label":"Réseaux de chaleur\\n\\nGwh de production de chaleur passé en ENR (annuel)\\n\\n3 628,24\\n\\n440 kt CO₂","value":439.7862476145672,"title":"Energie\\n\\nRéseaux de chaleur\\n\\nGwh de production de chaleur passé en ENR (annuel)\\n\\n3 628,24\\n\\n440 kt CO₂"},{"Leviers":"ENR électriques","Traduction physique":"MW puissance éolien installée","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":346.225219026153,"Objectifs SGPE en unité physique":449.129850334881,"secteur":"Energie","path":"Energie/ENR électriques","label":"ENR électriques\\n\\nMW puissance éolien installée\\n\\n449,13\\n\\n346 kt CO₂","value":346.225219026153,"title":"Energie\\n\\nENR électriques\\n\\nMW puissance éolien installée\\n\\n449,13\\n\\n346 kt CO₂"},{"Leviers":"ENR électriques","Traduction physique":"MW puissance PV installée","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":346.225219026153,"Objectifs SGPE en unité physique":760.0659005667216,"secteur":"Energie","path":"Energie/ENR électriques","label":"ENR électriques\\n\\nMW puissance PV installée\\n\\n760,07\\n\\n346 kt CO₂","value":346.225219026153,"title":"Energie\\n\\nENR électriques\\n\\nMW puissance PV installée\\n\\n760,07\\n\\n346 kt CO₂"},{"Leviers":"Report modal/ferroviaire et fluvial","Traduction physique":"Tkm PL évités (annuel)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":508.27747945596855,"Objectifs SGPE en unité physique":4320358.575375733,"secteur":"Transport","path":"Transport/Report modal-ferroviaire et fluvial","label":"Report modal/ferroviaire et fluvial\\n\\nTkm PL évités (annuel)\\n\\n4 320,36 K\\n\\n508 kt CO₂","value":508.27747945596855,"title":"Transport\\n\\nReport modal/ferroviaire et fluvial\\n\\nTkm PL évités (annuel)\\n\\n4 320,36 K\\n\\n508 kt CO₂"},{"Leviers":"Captage méthane ISDND","Traduction physique":"réduction d'emissions du secteur (annuel) (Captage méthane ISDND)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":832.7631556661024,"Objectifs SGPE en unité physique":0.3979816644161751,"secteur":"Déchêt","path":"Déchêt/Captage méthane ISDND","label":"Captage méthane ISDND\\n\\nréduction d'emissions du secteur (annuel) (Captage méthane ISDND)\\n\\n0,4\\n\\n833 kt CO₂","value":832.7631556661024,"title":"Déchêt\\n\\nCaptage méthane ISDND\\n\\nréduction d'emissions du secteur (annuel) (Captage méthane ISDND)\\n\\n0,4\\n\\n833 kt CO₂"},{"Leviers":"Valorisation matière","Traduction physique":"T valorisées grâce à une plus grande incorporation de MPR (annuel)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":340.67910920366484,"Objectifs SGPE en unité physique":851697.773009162,"secteur":"Déchêt","path":"Déchêt/Valorisation matière","label":"Valorisation matière\\n\\nT valorisées grâce à une plus grande incorporation de MPR (annuel)\\n\\n851,7 K\\n\\n341 kt CO₂","value":340.67910920366484,"title":"Déchêt\\n\\nValorisation matière\\n\\nT valorisées grâce à une plus grande incorporation de MPR (annuel)\\n\\n851,7 K\\n\\n341 kt CO₂"},{"Leviers":"Rénovation + sobriété tertiaire","Traduction physique":"réduction de consommation d'énergie annuelle (/2010)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":717.0477733025467,"Objectifs SGPE en unité physique":0.4,"secteur":"Tertiaire","path":"Tertiaire/Rénovation + sobriété tertiaire","label":"Rénovation + sobriété tertiaire\\n\\nréduction de consommation d'énergie annuelle (/2010)\\n\\n0,4\\n\\n717 kt CO₂","value":717.0477733025467,"title":"Tertiaire\\n\\nRénovation + sobriété tertiaire\\n\\nréduction de consommation d'énergie annuelle (/2010)\\n\\n0,4\\n\\n717 kt CO₂"},{"Leviers":"Tertiaire fioul","Traduction physique":"m² chauffés au fioul passés à une énergie décarbonnée d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1078.7258666489654,"Objectifs SGPE en unité physique":16180887.999734482,"secteur":"Tertiaire","path":"Tertiaire/Tertiaire fioul","label":"Tertiaire fioul\\n\\nm² chauffés au fioul passés à une énergie décarbonnée d'ici 2030\\n\\n16,18 M\\n\\n1 079 kt CO₂","value":1078.7258666489654,"title":"Tertiaire\\n\\nTertiaire fioul\\n\\nm² chauffés au fioul passés à une énergie décarbonnée d'ici 2030\\n\\n16,18 M\\n\\n1 079 kt CO₂"},{"Leviers":"Tertiaire gaz","Traduction physique":"m² chauffés au gaz passés à une énergie décarbonnée d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":497.75152987211294,"Objectifs SGPE en unité physique":14621451.189993318,"secteur":"Tertiaire","path":"Tertiaire/Tertiaire gaz","label":"Tertiaire gaz\\n\\nm² chauffés au gaz passés à une énergie décarbonnée d'ici 2030\\n\\n14,62 M\\n\\n498 kt CO₂","value":497.75152987211294,"title":"Tertiaire\\n\\nTertiaire gaz\\n\\nm² chauffés au gaz passés à une énergie décarbonnée d'ici 2030\\n\\n14,62 M\\n\\n498 kt CO₂"},{"Leviers":"Rénovation résidentiel","Traduction physique":"# logement (70m²) m2 rénovés en profondeur","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1001.72340323808,"Objectifs SGPE en unité physique":286206.6866394514,"secteur":"Résidentiel","path":"Résidentiel/Rénovation résidentiel","label":"Rénovation résidentiel\\n\\n# logement (70m²) m2 rénovés en profondeur\\n\\n286,21 K\\n\\n1 002 kt CO₂","value":1001.72340323808,"title":"Résidentiel\\n\\nRénovation résidentiel\\n\\n# logement (70m²) m2 rénovés en profondeur\\n\\n286,21 K\\n\\n1 002 kt CO₂"},{"Leviers":"Résidentiel fioul","Traduction physique":"# chaudières au fioul passées à une énergie décarbonnée d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1387.3343985744964,"Objectifs SGPE en unité physique":346833.5996436241,"secteur":"Résidentiel","path":"Résidentiel/Résidentiel fioul","label":"Résidentiel fioul\\n\\n# chaudières au fioul passées à une énergie décarbonnée d'ici 2030\\n\\n346,83 K\\n\\n1 387 kt CO₂","value":1387.3343985744964,"title":"Résidentiel\\n\\nRésidentiel fioul\\n\\n# chaudières au fioul passées à une énergie décarbonnée d'ici 2030\\n\\n346,83 K\\n\\n1 387 kt CO₂"},{"Leviers":"Résidentiel gaz","Traduction physique":"# chaudières au gaz  passées à une énergie décarbonnée d'ici 2030","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1050.9790286942696,"Objectifs SGPE en unité physique":403970.06415435986,"secteur":"Résidentiel","path":"Résidentiel/Résidentiel gaz","label":"Résidentiel gaz\\n\\n# chaudières au gaz  passées à une énergie décarbonnée d'ici 2030\\n\\n403,97 K\\n\\n1 051 kt CO₂","value":1050.9790286942696,"title":"Résidentiel\\n\\nRésidentiel gaz\\n\\n# chaudières au gaz  passées à une énergie décarbonnée d'ici 2030\\n\\n403,97 K\\n\\n1 051 kt CO₂"},{"Leviers":"ZAN (constr. neuve) ","Traduction physique":"ha prairies non artificialisés","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":243.66888608699892,"Objectifs SGPE en unité physique":840.2375382310307,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/ZAN (constr. neuve) ","label":"ZAN (constr. neuve) \\n\\nha prairies non artificialisés\\n\\n840,24\\n\\n244 kt CO₂","value":243.66888608699892,"title":"Agriculture/Forêts/Sols\\n\\nZAN (constr. neuve) \\n\\nha prairies non artificialisés\\n\\n840,24\\n\\n244 kt CO₂"},{"Leviers":"ZAN (constr. neuve) ","Traduction physique":"ha cultures non artificialisés","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":243.66888608699892,"Objectifs SGPE en unité physique":1282.4678215105207,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/ZAN (constr. neuve) ","label":"ZAN (constr. neuve) \\n\\nha cultures non artificialisés\\n\\n1 282,47\\n\\n244 kt CO₂","value":243.66888608699892,"title":"Agriculture/Forêts/Sols\\n\\nZAN (constr. neuve) \\n\\nha cultures non artificialisés\\n\\n1 282,47\\n\\n244 kt CO₂"},{"Leviers":"Haies et Agroforestierie","Traduction physique":"kml de haies supplémentaires d'ici 2030 (net)","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":160.8424124876128,"Objectifs SGPE en unité physique":5361.413749587094,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Haies et Agroforestierie","label":"Haies et Agroforestierie\\n\\nkml de haies supplémentaires d'ici 2030 (net)\\n\\n5 361,41\\n\\n161 kt CO₂","value":160.8424124876128,"title":"Agriculture/Forêts/Sols\\n\\nHaies et Agroforestierie\\n\\nkml de haies supplémentaires d'ici 2030 (net)\\n\\n5 361,41\\n\\n161 kt CO₂"},{"Leviers":"Retournement prairies","Traduction physique":"ha de moindre retournement des prairies","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":383.8613852879981,"Objectifs SGPE en unité physique":110304.99577241324,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Retournement prairies","label":"Retournement prairies\\n\\nha de moindre retournement des prairies\\n\\n110,3 K\\n\\n384 kt CO₂","value":383.8613852879981,"title":"Agriculture/Forêts/Sols\\n\\nRetournement prairies\\n\\nha de moindre retournement des prairies\\n\\n110,3 K\\n\\n384 kt CO₂"},{"Leviers":"Pratiques stockantes","Traduction physique":"ha supplémentaires en couverts intermédiaires","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":64.39734158321,"Objectifs SGPE en unité physique":153327.00376954762,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Pratiques stockantes","label":"Pratiques stockantes\\n\\nha supplémentaires en couverts intermédiaires\\n\\n153,33 K\\n\\n64 kt CO₂","value":64.39734158321,"title":"Agriculture/Forêts/Sols\\n\\nPratiques stockantes\\n\\nha supplémentaires en couverts intermédiaires\\n\\n153,33 K\\n\\n64 kt CO₂"},{"Leviers":"Forêts","Traduction physique":"hectares additionnels de forêt en croissance","Région":"Auvergne-Rhône-Alpes","Objectifs SGPE en kTCO2":1033.3293513319793,"Objectifs SGPE en unité physique":103332.93513319793,"secteur":"Agriculture/Forêts/Sols","path":"Agriculture/Forêts/Sols/Forêts","label":"Forêts\\n\\nhectares additionnels de forêt en croissance\\n\\n103,33 K\\n\\n1 033 kt CO₂","value":1033.3293513319793,"title":"Agriculture/Forêts/Sols\\n\\nForêts\\n\\nhectares additionnels de forêt en croissance\\n\\n103,33 K\\n\\n1 033 kt CO₂"}]`;

  const data = JSON.parse(dataSrc);
  let width;
  let height;

  $: console.log(height, width);
</script>

<svelte:window bind:innerWidth={width} bind:innerHeight={height} />

{#if width && height}
  <Treemap
    {data}
    path={(d) => d.path}
    label={(d) => d.label}
    group={(d) => d.secteur}
    value={(d) => d.value}
    title={(d, _n) => d.title}
    width={width - 20}
    height={height - 100}
    tile={d3.treemapSquarify}
  />
{/if}
